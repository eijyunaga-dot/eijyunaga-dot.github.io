<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>画像にスタンプしたり補正したりするやつ</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="correction.css">
</head>

<body>
    <div class="app-container">
        <!-- Screens -->

        <!-- 1. Home Screen -->
        <section id="homeScreen" class="screen active">
            <div class="home-content">
                <h1 class="app-title" data-i18n="appTitle">>画像にスタンプしたり補正したりするやつ</h1>
                <p class="app-subtitle" data-i18n="appSubtitle">下から選択して下さい</p>
                <div class="home-actions horizontal">
                    <button id="startBtn" class="btn primary large">
                        <span class="icon">📸</span> <span data-i18n="start">スタンプ</span>
                    </button>
                    <button id="correctionBtn" class="btn outline large">
                        <span class="icon">🔧</span> <span data-i18n="correction">画像補正</span>
                    </button>
                    <button id="settingsBtn" class="btn outline large">
                        <span class="icon">⚙️</span> <span data-i18n="settings">設定(言語/定型文)</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- 2. Settings Screen -->
        <section id="settingsScreen" class="screen">
            <header class="screen-header">
                <button class="back-btn" data-target="homeScreen">
                    <span class="icon">←</span> <span data-i18n="back">戻る</span>
                </button>
                <h2 data-i18n="settings">設定</h2>
            </header>
            <div class="settings-form">
                <div class="control-group">
                    <label data-i18n="language">言語 / Language</label>
                    <select id="languageSelect" class="language-select">
                        <option value="ja">日本語 (Japanese)</option>
                        <option value="en">English</option>
                        <option value="hi">हिन्दी (Hindi)</option>
                        <option value="vi">Tiếng Việt (Vietnamese)</option>
                        <option value="ne">नेपाली (Nepali)</option>
                    </select>
                </div>

                <div class="control-group">
                    <label data-i18n="managePresets">スタンプ定型文の管理</label>
                    <div class="preset-manager">
                        <div class="add-preset-row">
                            <input type="text" id="newPresetInput" placeholder="新しい定型文..."
                                data-i18n-placeholder="newPresetPlaceholder">
                            <button id="addPresetBtn" class="btn small primary">
                                <span data-i18n="add">追加</span>
                            </button>
                        </div>
                        <ul id="settingsPresetList" class="settings-preset-list">
                            <!-- Generated by JS -->
                        </ul>
                    </div>
                </div>
                <button id="resetPresetsBtn" class="btn outline danger">
                    <span data-i18n="resetPresets">初期設定に戻す</span>
                </button>
                <p id="settingsStatus" class="status-msg"></p>
            </div>
        </section>

        <!-- 3. Editor Screen -->
        <section id="editorScreen" class="screen">
            <header class="screen-header">
                <button class="back-btn" data-target="homeScreen">
                    <span class="icon">←</span> <span data-i18n="home">ホームへ</span>
                </button>
                <h2 data-i18n="edit">編集</h2>
            </header>

            <div class="workspace">
                <div class="canvas-container" id="canvasContainer">
                    <div class="upload-placeholder" id="uploadPlaceholder">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                            <circle cx="8.5" cy="8.5" r="1.5" />
                            <polyline points="21 15 16 10 5 21" />
                        </svg>
                        <p data-i18n="uploadPrompt">画像をタップまたはドラッグしてアップロード</p>
                        <input type="file" id="imageInput" accept="image/*" hidden>
                    </div>
                    <canvas id="editorCanvas"></canvas>
                </div>

                <aside class="controls">
                    <!-- Input Mode Switch -->
                    <div class="input-mode-switch">
                        <button class="mode-btn active" data-mode="preset">
                            <span data-i18n="modePreset">定型文</span>
                        </button>
                        <button class="mode-btn" data-mode="custom">
                            <span data-i18n="modeCustom">自由入力</span>
                        </button>
                    </div>

                    <!-- Stamp Management -->
                    <div class="stamp-management control-group">
                        <div class="stamp-actions">
                            <button id="addStampBtn" class="btn small primary outline">
                                <span data-i18n="addStamp">+ スタンプ追加</span>
                            </button>
                            <button id="deleteStampBtn" class="btn small danger outline" style="display: none;">
                                🗑️ <span data-i18n="delete">削除</span>
                            </button>
                        </div>
                        <p class="help-text small" style="margin-top: 4px; text-align: center;"
                            data-i18n="addStampHelp">定型文をタップして変更</p>
                        <p class="help-text small" style="margin-top: 2px; text-align: center; color: #999;"
                            data-i18n="selectStampHelp">
                            追加は追加ボタンの後に文字を選択</p>
                    </div>

                    <!-- Preset Input -->
                    <div id="presetControls" class="control-group">
                        <label data-i18n="selectStamp">スタンプを選択</label>
                        <div class="preset-grid" id="presetGrid">
                            <!-- Generated by JS -->
                        </div>
                    </div>

                    <!-- Custom Input -->
                    <div id="customControls" class="control-group" style="display: none;">
                        <label for="textInput" data-i18n="textInput">テキスト入力</label>
                        <input type="text" id="textInput" placeholder="ここに入力..." value="Sample Text"
                            data-i18n-placeholder="textInputPlaceholder">
                    </div>

                    <div class="control-group">
                        <label data-i18n="fontSize">フォントサイズ</label>
                        <input type="range" id="fontSizeInput" min="10" max="200" value="50">
                    </div>

                    <div class="control-group">
                        <label data-i18n="opacity">透明度</label>
                        <input type="range" id="opacityInput" min="0" max="1" step="0.1" value="0.9">
                    </div>

                    <div class="control-group">
                        <label data-i18n="textColor">文字色</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="colorInput" value="#ffffff">
                            <span id="colorValue">#FFFFFF</span>
                        </div>
                    </div>

                    <div class="actions vertical">
                        <button id="saveLocalBtn" class="btn primary" disabled>
                            <span>📱</span> <span data-i18n="saveDevice">本体に保存</span>
                        </button>
                        <button id="savePCBtn" class="btn secondary" disabled>
                            <span>💻</span> <span data-i18n="savePC">画像を保存(PC)</span>
                        </button>
                        <button id="previewBtn" class="btn outline" disabled>
                            <span>📋</span> <span data-i18n="previewOld">プレビュー(旧iPad用)</span>
                        </button>
                        <button id="resetBtn" class="btn outline danger" disabled>
                            <span data-i18n="reset">リセット</span>
                        </button>
                    </div>
                </aside>
            </div>
        </section>

        <!-- 4. Image Correction Screen -->
        <section id="correctionScreen" class="screen">
            <header class="screen-header">
                <button class="back-btn" data-target="homeScreen">
                    <span class="icon">←</span> <span data-i18n="back">戻る</span>
                </button>
                <h2 data-i18n="correction">画像補正</h2>
            </header>

            <div class="correction-workspace">
                <div class="correction-canvas-container">
                    <div class="upload-placeholder" id="correctionUploadPlaceholder">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                            <circle cx="8.5" cy="8.5" r="1.5" />
                            <polyline points="21 15 16 10 5 21" />
                        </svg>
                        <p data-i18n="uploadPrompt">画像をタップまたはドラッグしてアップロード</p>
                        <input type="file" id="correctionImageInput" accept="image/*" hidden>
                    </div>
                    <canvas id="correctionCanvas"></canvas>
                </div>

                <div class="correction-controls">
                    <div class="correction-info" id="correctionInfo">
                        <p class="help-text">画像を選択してください</p>
                    </div>

                    <div class="correction-buttons">
                        <button id="autoCorrectionBtn" class="btn primary" disabled>
                            ✨ <span data-i18n="autoCorrection">自動補正</span>
                        </button>
                        <button id="darkCorrectionBtn" class="btn primary" disabled>
                            💡 <span data-i18n="darkCorrection">固定補正(暗い画像)</span>
                        </button>
                        <button id="sizeCorrectionBtn" class="btn primary" disabled>
                            📦 <span data-i18n="sizeCorrection">サイズ補正(1MB)</span>
                        </button>
                    </div>

                    <div class="correction-actions">
                        <button id="saveCorrectedLocalBtn" class="btn primary" disabled>
                            📱 <span data-i18n="saveDevice">本体に保存(スマホ等)</span>
                        </button>
                        <button id="saveCorrectedPCBtn" class="btn secondary" disabled>
                            💻 <span data-i18n="savePC">画像を保存(PC)</span>
                        </button>
                        <button id="saveCorrectedPreviewBtn" class="btn outline" disabled>
                            📋 <span data-i18n="previewOld">プレビュー(旧iPad用)</span>
                        </button>
                        <button id="resetCorrectionBtn" class="btn outline danger" disabled>
                            <span data-i18n="reset">リセット</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Preview Modal -->
        <div id="previewModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 data-i18n="previewTitle">プレビュー</h3>
                    <button class="close-modal-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <p class="modal-instruction" data-i18n="previewInstruction">画像を長押しして「写真に保存」を選択してください</p>
                    <img id="previewImage" src="" alt="Preview">
                </div>
                <div class="modal-footer">
                    <button class="btn outline close-modal-btn" data-i18n="close">閉じる</button>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
    <script src="correction.js"></script>
</body>

</html>